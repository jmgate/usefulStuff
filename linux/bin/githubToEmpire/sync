#!/bin/bash
echo "┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓"
echo "┃ Syncing GitHub's Trilinos to EMPIRE's ┃"
echo "┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛"
date
cd /home/jmgate/githubToEmpire/Trilinos

# Grab the latest from github.
echo ""
echo "Grabbing the latest from GitHub..."
echo "──────────────────────────────────"
git fetch github

# Update the master branch.  This should be a fast-forward merge.
echo ""
echo "Updating the master branch..."
echo "─────────────────────────────"
git checkout master
tmp=tmpFile$(date +%m%d%y%H%M%S)
git merge github/master &> $tmp
cat $tmp
result=$(tail -n 1 $tmp)
rm $tmp
if [[ "$result" != "Already up-to-date." ]]; then
  git push empire master
fi

# Update the develop branch.  This should be a fast-forward merge.
echo ""
echo "Updating the develop branch..."
echo "──────────────────────────────"
git checkout develop
tmp=tmpFile$(date +%m%d%y%H%M%S)
git merge github/develop &> $tmp
cat $tmp
result=$(tail -n 1 $tmp)
rm $tmp
if [[ "$result" == "Already up-to-date." ]]; then
  exit 0
fi

# Run EMPIRE's test suite.
echo ""
echo "Running EMPIRE's test suite..."
echo "──────────────────────────────"
echo "Just kidding -- haven't set this up yet."

# Push the results to empire develop.
echo ""
echo "Pushing the changes to EMPIRE's develop..."
echo "──────────────────────────────────────────"
git push empire develop
